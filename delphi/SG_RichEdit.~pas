unit SG_RichEdit;

interface

uses
  comctrls,
  dbtables,
  db;

procedure richEditToSQLImageField(richEdit:TRichEdit;BDEDataSet:TBDEDataSet;
  field:TField);

procedure SQLImageFieldToRichEdit(richEdit:TRichEdit;BDEDataSet:TBDEDataSet;
  field:TField);

implementation

uses
  classes;
  
procedure richEditToSQLImageField(richEdit:TRichEdit;BDEDataSet:TBDEDataSet;
  field:TField);
var
  BlobStream : TBlobStream;
begin
  try
    blobStream:=BDEDataSet.CreateBlobStream(field,bmWrite) as TBlobStream;
    RichEdit.Lines.SaveToStream(BlobStream);
  finally
    //BlobStream.Free;
  end;
end;

procedure SQLImageFieldToRichEdit(richEdit:TRichEdit;BDEDataSet:TBDEDataSet;
  field:TField);
var
  BlobStream : TBlobStream;
begin
  try
    blobStream:=BDEDataSet.CreateBlobStream(field,bmRead) as TBlobStream;
    if (not field.IsNull) then
    begin
      RichEdit.Lines.LoadFromStream (BlobStream);
    end;
  finally
    //BlobStream.Free;
  end;
end;

end.
